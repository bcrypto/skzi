% Services
\section{Реализация сервисов (РС)}\label{SV}

\subsection{Обзор}\label{SV.Intro}

Пакет РС устанавливает требования к сервисам, реализованным в СКЗИ.
%
Требования распространяются на все сервисы, не только криптографические.

Сервис описывается интерфейсом~--- набором правил взаимодействия,
в том числе соглашениями о входных и выходных данных.
%
Интерфейс может быть реализован разными способами:
%
быть программным (в виде набора функций и структур данных для сопряжения
с клиентской программой), графическим (окна, формы ввода),
аппаратным (кнопки, тумблеры, индикаторы)
или интерфейсом командной строки (команды терминала)~\forref{R.SV.List}.

Некоторые криптографические операции могут выполняться не одним, а несколькими
сервисами. Например, защита канала связи может быть реализована сервисом
выработки общего сеансового ключа, сервисом шифрования данных канала и сервисом
обнуления сеансового ключа.
%
Определенные последовательности вызовов сервисов могут быть запрещены. Например,
запрещено выполнять шифрование до выработки сеансового ключа или сразу после его
обнуления~\forref{R.SV.List}.

Сервис может классифицироваться как критический, и тогда повышается контроль над
его вызовами: \addendum{вызов сервиса по ошибке или из-за сбоя в 
системной среде блокируется.} 
\addendum{К критическим следует относить сервисы, непреднамеренный вызов 
которых приводит к потере работоспособности СКЗИ или, наоборот, к
непредусмотренной работе~\forref{R.SV.Crit}.}

При вызове \addendum{критического сервиса} проводится проверка срабатывания как 
минимум двух \addendum{независимых триггеров, основанных на возникновении 
определенных событий или выполнении определенных условий}. 
\addendum{
Например, в качестве первого триггера может выступать собственно вызов сервиса, 
в качестве второго~--- подтверждение вызова, сделанное оператором через нажатие 
кнопки графического интерфейса~\forref{R.SV.Crit}.}

\subsection{Требования}\label{SV.Reqs}

\req{РС}{1--4}\label{R.SV.List}
Должны быть определены и \addendum{корректно 
реализованы~\forref{R.CR.Embed,R.CR.Selected,R.CR.Detailed}}  
сервисы~СКЗИ.
%
Для каждого сервиса должно быть определено его назначение, 
входные и выходные данные, признак критичности.
%
Должны быть указаны допустимые последовательности вызовов сервисов.
%
\addendum{
Должны быть выделены криптографические сервисы.
В них должны использоваться алгоритмы перечня~\useref{R.CS.Algs}.
}

\req{РС}{1--4}\label{R.SV.Oblig}
В список сервисов должны быть~\forref{R.SV.List} включены:
\begin{itemize}
\item[--]
сервис вывода номера версии~СКЗИ;
\item[--]
сервисы самотестирования~\useref{R.ST.Tests};
\item[--]
по крайней мере один криптографический сервис\addendum{.}
\end{itemize}

\req{РС}{1--4}\label{R.SV.Robust}
На любых входных данных сервис~\useref{R.SV.List} должен нормально 
завершаться, т.~е. возвращать правильный результат,  
в том числе признак некорректных входных данных.

\req{РС}{2--4}\label{R.SV.Leaks}
Сервис~\useref{R.SV.List}, который выполняет операцию над критическими
объектами~\useref{R.AC.Objects}, должен быть реализован так, чтобы после его
завершения в пределах криптографической границы не оставалось 
неявных копий критических объектов в \addendum{незашифрованном} виде.

\begin{note*}
Неявная копия может остаться в файле подкачки операционной системы, 
регистрах процессора, журнале аудита. 
\end{note*}

\req{РС}{1--4}\label{R.SV.Crit}
Критический сервис~\useref{R.SV.List} должен быть реализован так,
что он успешно завершается только при срабатывании двух и более 
\addendum{независимых триггеров}.

\req{РС}{2--4}\label{R.SV.Seq}
Сервисы~\useref{R.SV.List} должны быть реализованы так, чтобы их вызов в
некорректной последовательности отслеживался и блокировался.

\req{РС}{3, 4}\label{R.SV.Status}
В список сервисов должен быть~\forref{R.SV.List} включен
сервис вывода текущего состояния СКЗИ~\useref{R.AC.States}.

