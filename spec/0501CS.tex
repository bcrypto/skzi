% Cryptographic Support
\section{Криптографическая поддержка (КП)}\label{CS}

\subsection{Обзор}\label{CS.Intro}

Пакет КП устанавливает требования к криптографическим алгоритмам, реализованным
в СКЗИ.
%
Требования распространяются на алгоритмы, которые используются как в доступных
извне сервисах, так и во внутренних механизмах обеспечения безопасности
сервисов.
%
Требования распространяются на криптографические протоколы~---
интерактивные криптографические алгоритмы.

Входные данные криптографического алгоритма представляют собой объекты, которые
требуется обработать (зашифровать, расшифровать, подписать и др.), а также
служебные объекты, которые определяют способ обработки.
%
К служебным объектам относятся долговременные параметры, которые задают
семейство криптографических преобразований для данного алгоритма, ключи, которые
определяют выбор одного преобразования из семейства, синхропосылки, которые
обеспечивают уникальность результатов преобразования на фиксированном ключе, 
и др.

Криптографические алгоритмы делятся на алгоритмы с секретным ключом
(симметричные), алгоритмы с открытым ключом (асимметричные) и бесключевые
алгоритмы.
%
В симметричных алгоритмах для выполнения нескольких связанных операций, например
зашифрования и расшифрования, используется один и тот же секретный ключ.
%
В асимметричных алгоритмах используется пара ключей~--- личный и соответствующий
ему открытый. Например, в алгоритмах ЭЦП при выработке подписи используется
личный ключ, а при ее проверке~--- открытый.
%
К бесключевым относятся алгоритмы хэширования, алгоритмы разделения секрета,
алгоритмы построения семейства ключей по одному главному ключу. В этих
алгоритмах ключи, отвечающие за выбор криптографического преобразования, не
используются, хотя обрабатываемые объекты сами могут являться 
ключами~\forref{R.CS.Algs}.

Долговременные параметры и ключи криптографического алгоритма
могут генерироваться в СКЗИ, импортироваться из-за его 
пределов или входить в состав СКЗИ, будучи заданными в его программах или 
конфигурационных файлах.
%
Ключи могут генерироваться в СКЗИ онлайн~--- в рамках протокола 
формирования общего ключа с удаленной стороной~\forref{R.CS.Gen}.

При реализации криптографического алгоритма с секретным или личным ключом 
следует учитывать существование атак, в которых по времени выполнения алгоритма
противник получает информацию о ключе. Время выполнения выступает в роли 
побочного канала.
%
Для защиты от атак в реализациях алгоритмов следует использовать практики 
регулярного (constant-time) криптографического программирования: отказаться от 
ключезависимых условных переходов, исключить ключезависимые задержки при 
загрузке данных из массивов памяти~\forref{R.CS.Timing}.

\subsection{Требования}\label{CS.Reqs}

\req{КП}{1--4}\label{R.CS.Algs}
Должны быть определены и корректно реализованы криптографические алгоритмы~СКЗИ. 
%
Каждый алгоритм должен быть однозначно идентифицирован: должен быть указан его
тип, дана ссылка на спецификацию, определены режим работы, поддерживаемые длины
ключей.

\begin{note}
При реализации криптографического алгоритма разрешается сужать множество
обрабатываемых объектов. Например, алгоритм шифрования может обрабатывать
сообщения не любой, а только определенной длины. Вместе с тем сужение множества
ключей не допускается.
\end{note}

\req{КП}{1--4}\label{R.CS.Std}
Спецификации криптографических алгоритмов~\useref{R.CS.Algs}
должны быть приняты в качестве ТНПА.

\req{КП}{1--4}\label{R.CS.Gen}
Если в~СКЗИ предусмотрена генерация долговременных параметров и ключей 
криптографического алгоритма~\useref{R.CS.Algs}, то методы генерации 
должны быть определены и корректно реализованы.
%
Методы генерации должны соответствовать спецификации
алгоритма~\useref{R.CS.Std}, возможно уточняя или расширяя ее.

\begin{note}
Методы генерации могут определяться в спецификации рамочно, без исчерпывающих 
деталей.
%
Например, при генерации параметров ЭЦП на основе эллиптических кривых
используются вспомогательные алгоритмы проверки простоты чисел, расчета порядка
группы точек эллиптической кривой, которые могут быть не определены в спецификации.
%
При реализации в~СКЗИ методов генерации параметров проводится уточнение 
вспомогательных алгоритмов.
%
Уточнения могут касаться также способов генерации случайных чисел,
по которым строятся целевые долговременные параметры или ключи,
или протоколов, с помощью которых ключи генерируются интерактивно.
\end{note}

\req{КП}{2--4}\label{R.CS.Timing}
Криптографический алгоритм~\useref{R.CS.Algs},
а также методы генерации его ключей, должны быть реализованы так,
чтобы по времени их выполнения нельзя было сделать вывод об
используемых или генерируемых личных и секретных ключах.

\req{КП}{1--4}\label{R.CS.ValPar}
При включении в состав СКЗИ заранее сгенерированных долговременных параметров 
криптографического алгоритма~\useref{R.CS.Algs} должно быть подтверждено, 
что параметры получены в соответствии со спецификацией на алгоритм.

\begin{note}
При использовании стандартных параметров, заданных в 
спецификации, подтверждением является ссылка на нее. 
%
В других случаях в качестве подтверждения могут выступать
затравочные значения, использованные при генерации,
или расчеты, демонстрирующие соблюдение метрик качества параметров.
\end{note}

\req{КП}{1--4}\label{R.CS.ChangePar}
При смене долговременных параметров криптографического
алгоритма~\useref{R.CS.Algs} должна выполняться смена его ключей. Другими
словами, ключ криптографического алгоритма не должен использоваться с двумя
различными наборами долговременных параметров.

% todo: выполняться смена его ключей -> прекращаться действие его ключей
% todo: генерация ключа по паролю в PACE? сильный по слабому?
