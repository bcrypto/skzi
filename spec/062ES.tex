% Environment Setup
\section{Настройка среды (НС)}\label{ES}

\subsection{Обзор}\label{ES.Defs}

Пакет НС устанавливает требования по настройке системной среды СКЗИ.
Настройка повышает гарантии безопасности системных объектов СКЗИ,
увеличивает доверие к КСК, усиливает контроль над средой.
%
Настройка особенно важна для программных СКЗИ, которые сильно зависимы от 
среды.

В основном подразумевается настройка операционной системы.
%
При настройке конфигурируются средства защиты операционной системы, 
задаются разрешения на установку программ, 
вводятся ограничения на доступ к системным объектам и др.
%
Предполагается, что операционная система имеет подсистемы управления 
доступом и управления 
процессами~\forref{R.ES.Install,R.ES.Objects,R.ES.Session}.

\subsection{Требования}\label{ES.Reqs}

\req{НС}{1--4}\label{R.ES.Install}
Должны быть определены настройки системной среды
для безопасной установки~СКЗИ уполномоченным администратором.

\begin{note}
При настройке операционной системы должна быть настроена политика
управления доступом, механизмы аутентификации. Должна быть определена группа
операторов, которая имеет право устанавливать программы. Группа должна включать
администраторов СКЗИ и только их.
\end{note}

\req{НС}{1--4}\label{R.ES.Objects}
Должны быть определены настройки системной среды
для обеспечения целостности долговременных объектов~\useref{R.AC.Objects} 
при их хранении внутри криптографической границы. 
%
Выбранные настройки должны предотвращать 
изменение долговременных объектов вне сеансов между операторами и~СКЗИ.

\begin{note}
При настройке операционной системы должна быть настроен
доступ к каталогам и файлам, в которых хранятся системные объекты
и объекты явных операторов. Права доступа должны соответствовать 
политике управления доступом СКЗИ~\useref{R.AC.Policy}.
\end{note}

\req{НС}{1--4}\label{R.ES.Session}
Должны быть определены настройки системной среды
для обеспечения конфиденциальности и целостности сеансовых 
объектов~\useref{R.AC.Objects} и аутентификационных 
данных~\useref{R.IA.AuthData} при их передаче и  
обработке в КСК во время сеансов операторов.

\begin{note}
При настройке операционной системы должна быть обеспечена защита 
процессов, которые запускаются во время сеансов операторов:

--~процесс, включая его адресное пространство, не может быть 
изменен другими процессами операционной системы;

--~адресное пространство процесса не может быть прочитано другими процессами 
операционной системы.
\end{note}

\req{НС}{2--4}\label{R.ES.CVE}
Должны отслеживаться уязвимости КСК. При их обнаружении должны 
устанавливаться обновления, осуществляться переход на признаваемые надежными
версии КСК или на другие КСК.

\begin{note}
Уязвимости могут отслеживаться автоматически самой системной средой.
Или отслеживание проводится во время разработки СКЗИ по аналитическим
материалам из доступных источников. Разработчик использует результаты
отслеживания при выборе надежных КСК или надежных версий КСК.
\end{note}

\req{НС}{2--4}\label{R.ES.AuthCode}
В системной среде должно быть разрешено устанавливать только те программы,
целостность и подлинность которых подтверждена.

% todo: только для уровня 2?

\req{НС}{3, 4}\label{R.ES.NoCode}
В системной среде должно быть запрещено устанавливать дополнительные программы.
Возможно только обновление программ СКЗИ.

\req{НС}{4}\label{R.ES.OS}
Операционная система должна входить в состав СКЗИ.

\begin{note}
Включение операционной системы в состав СКЗИ означает, что она подпадает под  
тестирование и выборочный анализ исходных текстов. Речь может идти 
о минималистской операционной системе собственной разработки или 
об облегченной операционной системе с открытым кодом.
\end{note}

