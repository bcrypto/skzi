% Access Control
\section{Управление доступом (УД)}\label{AC}

\subsection{Обзор}\label{AC.Intro}

Пакет УД устанавливает требования к организации доступа к сервисам и объектам 
СКЗИ.
%
Субъектами доступа являются операторы, они обращаются к сервисам, 
а также сами сервисы, они обращаются к другим сервисам и объектам.
%
Перечень допустимых операций субъектов над единицами доступа 
регламентируется политикой управления доступом.

По умолчанию любой субъект может использовать ресурсы любого КСК. Если требуется
ограничить доступ к определенному КСК, то этот компонент может вводиться в
политику в качестве дополнительной единицы доступа~\forref{R.AC.Policy}.

Объекты СКЗИ делятся на открытые и критические, сеансовые и долговременные.
%
Сеансовые объекты создаются во время сеансов операторов и уничтожаются
при их завершении. Доступ к таким объектам имеет только оператор сеанса.
%
Долговременные объекты существуют как во время, так и вне времени выполнения
сеансов, хранятся в пределах криптографической границы или передаются за ее
пределы.
%
Доступ к долговременным объектам имеют все операторы с соответствующими 
правами. Например, личный ключ подписи является долговременным объектом, а 
генерируемый при выработке подписи одноразовый ключ~--- 
сеансовым~\forref{R.AC.Objects}.

У объектов есть владельцы. 
%
Администратор может владеть журналом аудита, 
пользователь~--- ключами.
%
Владелец может быть один (пример: личный ключ),
их может быть два (секретный ключ парной связи) или несколько 
(журнал во владении группы администраторов).
%
Файлы программ и конфигураций относятся к системным объектам,
владельцем которых является системный оператор~\forref{R.AC.Objects}.

Критический объект может быть объявлен неизвлекаемым, и тогда его 
вывод за пределы криптографической границы СКЗИ блокируется или серьезно 
ограничивается~\useref{R.DP.NonExtr}. Оставаясь в пределах границы, 
неизвлекаемый объект надежно связывается со своим владельцем. В качестве 
владельца может выступать системный оператор, то есть сам СКЗИ. Неизвлекаемый 
системный объект следует использовать всегда, когда СКЗИ является 
криптографическим автоматом, т.~е. выступает от собственного лица при 
взаимодействии с другими сторонами (см. СТБ 34.101.78)~\forref{R.AC.Objects}.

Права доступа в политике определяются ролью оператора. 

Предусмотрена обязательная роль <<Администраторы>>. 
Ее оператор наделен правами выполнять сервисы управления~СКЗИ, например, 
устанавливать и настраивать СКЗИ, управлять правами операторов, 
вводить ключи защиты объектов СКЗИ~\forref{R.AC.Roles}.

Рекомендуется вводить роль <<Пользователи>>. Пользователь выполняет общие
сервисы СКЗИ, в том числе криптографические: генерирует ключи, устанавливает
защищенные соединения, проверяет ЭЦП электронных 
документов~\forref{R.AC.Roles}.

Может вводиться роль <<Супервизоры>>. 
Супервизор выполняет технологические сервисы: 
устанавливает встроенное программное обеспечение,
персонализирует и диагностирует СКЗИ, проводит штатное 
обслуживание~\forref{R.AC.Roles}.

Имеется предопределенная роль <<Система>>, которая явно может не вводиться.
%
Неявный оператор этой роли (системный оператор) представляет 
системную среду и от ее лица выполняет внутренние сервисы~СКЗИ, 
начиная с включения (запуска программ) и заканчивая выключением 
(завершением программ).
%
% Операции политики сами являются системными сервисами, доступ к которым 
% неявно (либо явно, при включении в список сервисов) регулируется политикой.

Для реализации политики управления доступом системный сеанс 
(сеанс системного оператора) детализируется~--- в нем 
выделяются состояния, соответствующие сеансам операторов той или иной явной 
роли. 
%
Системный сеанс переходит в одно из таких состояний после успешной 
аутентификации оператора, и после перехода действуют права доступа 
роли~\forref{R.AC.OpStates}. 

Аутентификация может не проводиться, если в СКЗИ предусмотрен 
режим автономной работы. В этом режиме сеанс оператора явной роли,
в котором СКЗИ находилось перед выключением, возобновляется после включения. 
Режим автономной работы инициируется специальным сервисом~\forref{R.AC.Auto}. 

В сеансе оператора могут выделяться собственные состояния, в них права  
доступа могут уточняться. 
%
Права доступа могут уточняться и в зависимости от других факторов,
например, признака владения объектом доступа~\forref{R.AC.Policy}.

В системном сеансе СКЗИ имеются состояния, не связанные с сеансами явных 
операторов. В них права доступа также уточняются. 
%
В частности, в состоянии блокировки выполнение сервисов 
сильно ограничивается, а в состоянии полной блокировки~--- запрещается. 

\subsection{Требования}\label{AC.Reqs}

\req{УД}{1--4}\label{R.AC.Roles} % 1
Должны быть определены роли операторов~СКЗИ. 
Должна быть предусмотрена роль <<Администраторы>>.

\req{УД}{1--4}\label{R.AC.Objects} % 2
Должны быть определены объекты~СКЗИ.
Для каждого объекта должно быть задано его назначение,
проведена классификация (открытый или критический, сеансовый или 
долговременный), указан срок действия (время жизни), определен владелец.
Должны быть перечислены неизвлекаемые критические объекты (при наличии).

\begin{note}
При выполнении сервисов может создаваться несколько сеансовых копий одного 
и того же объекта в нескольких переменных программ.
%
Сеансовые копии необязательно определять как отдельные объекты,
достаточно обеспечить их очистку по завершении сеансов~\useref{R.DP.Session}.
\end{note}

\begin{note}
К объектам~СКЗИ не относятся секреты аутентификации~\useref{R.IA.AuthData},
которые циркулируют в среде эксплуатации без контроля со стороны СКЗИ.
%
Однако контрольные значения секретов могут быть долговременными объектами~СКЗИ.
Кроме этого, в ходе сеансов на основе аутентификационных данных могут
вырабатываться сеансовые объекты (например, хэш-значение пароля, используемое в
качестве ключа), которые находятся под контролем~СКЗИ.
\end{note}

\req{УД}{1--4}\label{R.AC.Policy} % 3
Должна быть определена и корректно реализована~\forref{R.CR.Selected,R.CR.Detailed} 
политика управления доступом~СКЗИ.
Политика должна устанавливать набор допустимых 
операций операторов различных ролей~\useref{R.AC.Roles} 
над сервисами~\useref{R.SV.List} и сервисов, 
выступающих от имени операторов, над объектами~\useref{R.AC.Objects},
другими сервисами и, при необходимости ограничения доступа, 
критическими системными компонентами~\useref{R.ST.CSCList}.

\begin{note}
Стандартные операции: 
выполнение (X) сервисов; 
создание~/ генерация (C), удаление~/ очистка (D), экспорт (E), импорт (I), 
чтение (R) и запись (W) объектов; 
использование (U) ресурсов КСК.
%
Могут вводиться другие операции.
\end{note}

\begin{note}
Доступ к файлу с защищенным критическим объектом не считается операцией 
чтения, если защита с объекта не снята. Однако копирование файла за пределы 
криптографической границы может считаться операцией экспорта, если защиту 
предполагается снять позже.
\end{note}

\req{УД}{1--4}\label{R.AC.States} % 4
Должны быть определены состояния~СКЗИ. Должны быть определены и 
корректно реализованы~\forref{R.CR.Selected,R.CR.Detailed} правила 
перехода между состояниями. Должны быть предусмотрены следующие состояния:
\begin{itemize}
\item
состояние включения (запуска программ);
\item
состояния, соответствующие сеансам операторов различных ролей~\useref{R.AC.Roles};
\item
состояние блокировки;
\item
состояние выключения (завершения программ).
\end{itemize}

\begin{note}
Примеры других состояний:
<<самотестирование>>,
<<ожидание>> (до аутентификации операторов),
<<временная блокировка>> (блокировка на определенный период времени
после превышения порога неудачных попыток аутентификации).
\end{note}

\req{УД}{1--4}\label{R.AC.OpStates} % 5
В состояниях, соответствующих сеансам операторов явных
ролей~\useref{R.AC.Roles}, должна действовать политика управления 
доступом~\useref{R.AC.Policy} относительно данных ролей.
%
Перед переходом в состояния должна проводиться аутентификация
операторов~\useref{R.IA.Auth}.

\begin{note}
Многозадачные операционные системы могут поддерживать 
одновременное выполнение сеансов для нескольких явных операторов~СКЗИ.
При этом состояния <<сеанс оператора той или иной>> дублируются. 
Считается, что~СКЗИ одновременно находится сразу во всех этих состояниях. 

%Один из возможных способов организации такой поддержки состоит в следующем.
%Клиентская программа является отдельным процессом операционной системы 
%с~защищенным от других процессов адресным пространством.
%Сеансами являются отдельные потоки клиентского процесса. 
%Данные сеансов одного процесса не защищены друг от друга,
%но защищены от данных сеансов других процессов.
%Для одновременного доступа к одним и тем же объектам
%нескольких сеансов средствами~СКЗИ или операционной системы 
%реализуются механизмы синхронизации.
\end{note}

\req{УД}{1--4}\label{R.AC.LockState} % 6
В состоянии блокировки~\useref{R.AC.States} должно быть запрещено выполнение 
всех сервисов, кроме следующих:
\begin{itemize}
\item
сервисы самотестирования~\useref{R.ST.Tests};
\item
сервисы аутентификации администратора~\useref{R.IA.Auth};
\item
вспомогательные сервисы, не связанные с обработкой объектов внутри 
криптографической границы;
\item
криптографические сервисы, которые сохранили работоспособность по 
результатам самотестирования и доступ к которым необходим для корректного
завершения сеанса оператора.
\end{itemize}
%
При переходе в состояние блокировки должны быть завершены все открытые сеансы 
операторов.
%
Если перед выключением СКЗИ находилось в состоянии блокировки, то оно должно
вернуться в это состояние сразу после включения.

\req{УД}{1--4}\label{R.AC.Auto} % 7
Cервис запуска автономной работы СКЗИ, если он имеется, 
должен быть включен~\forref{R.SV.List} в перечень сервисов как критический.
Доступ к сервису должны иметь~\forref{R.AC.Policy} только администраторы.

\req{УД}{1--4}\label{R.AC.DevRole} % 8
Если в СКЗИ предусмотрена роль <<Супервизоры>>~\useref{R.AC.Roles},
то операторы этой роли не должны иметь~\forref{R.AC.Policy} доступ 
на чтение (прямой или косвенный) к критическим объектам других операторов.

\req{УД}{4}\label{R.AC.CrashState} % 9
Перечень состояний СКЗИ должен включать~\forref{R.AC.States} состояние полной 
блокировки. 
%
В этом состоянии должно быть запрещено выполнение всех сервисов, кроме 
сервисов роли <<Супервизоры>>.
%
При переходе в состояние полной блокировки должны быть завершены 
все открытые сеансы операторов, удалены критические объекты в незашифрованном 
виде.
%
Если перед выключением СКЗИ находилось в состоянии полной блокировки, то оно
должно вернуться в это состояние сразу после включения.

