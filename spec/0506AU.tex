% Audit
\section{Аудит (АУ)}\label{AU}

\subsection{Обзор}\label{AU.Defs}

Пакет АУ устанавливает требования к регистрации событий безопасности.
События фиксируются в журнале аудита, представляющем собой набор 
записей аудита.
%
Администратор может просмотреть журнал с помощью сервисов СКЗИ.
Или журнал можно экспортировать и обработать с помощью внешних программ.

Журнал аудита имеет ограниченный размер. При превышении размера
СКЗИ может быть переведен в состояние блокировки, из которого быть
выведен администратором после удаления наиболее старых записей аудита. 
%
Сегменты старых записей низкого уровня критичности могут удаляться 
автоматически~\forref{R.AU.Over}.

\subsection{Требования}\label{AU.Reqs}

% Регистрация

\req{АУ}{3, 4}\label{R.AU.Log}
Должна быть реализована регистрация событий безопасности в журнале аудита.
Журнал должен быть~\forref{R.AC.Policy} отнесен к критическим объектам
администратора.

\req{АУ}{3, 4}\label{R.AU.Events}
В перечень регистрируемых событий должны быть включены:
\begin{itemize} 
\item
включение и выключение СКЗИ~\useref{R.AC.States};
\item
управление ролью <<Администраторы>>~\useref{R.AC.Roles}: 
добавление и исключение операторов; 
\item
изменение, экспорт, импорт критических объектов~\useref{R.AC.Objects}; 
\item
изменение системных объектов~\useref{R.AC.Objects}; 
\item
некорректные входные данные сервисов администраторов~\useref{R.SV.Robust};
\item
переход в состояние блокировки~\useref{R.AC.LockState}.
\end{itemize}

\begin{note}
Должны регистрироваться, в том числе, операции над журналом аудита.
\end{note}

\req{АУ}{3, 4}\label{R.AU.Records}
Записи аудита должны содержать следующую информацию:
\begin{itemize} 
\item
дата и время события;
\item
тип события; 
\item
идентификатор оператора (если проведена аутентификация); 
\item
результат (успех или неудача) события; 
\item
подробности в зависимости от типа события:
объект и операция над ним,
вид сбоя при переходе в состояние блокировки,
описание некорректных входных данных сервисов,
другое.
\end{itemize}
Записи аудита не должны содержать информацию о значениях критических объектов.  

\begin{note}
Если СКЗИ не располагает таймером, то могут быть указаны примерные дата и время
или даже просто номер события.
%
В одну запись аудита разрешено помещать информацию сразу о нескольких событиях. 
\end{note}

% Переполнение

\req{АУ}{3, 4}\label{R.AU.Over}
Должен быть определен порог числа записей журнала аудита.
При превышении порога должны быть предприняты действия,
направленные на сохранение приемлемого размера журнала
и минимизацию потерь информации аудита.

\req{АУ}{3, 4}\label{R.AU.Settings}
Если в СКЗИ реализованы сервисы настройки порога числа записей и 
предпринимаемых при превышении порога действий, то данные сервисы должны 
быть~\forref{R.AC.Policy} доступны только администраторам. 

