\NeedsTeXFormat{LaTeX2e}% LaTeX 2.09 can't be used (nor non-LaTeX)
[1994/12/01]% LaTeX date must December 1994 or later
\ProvidesPackage{defs}[1999/11/29 v1.2d]

%%%%%%%%%%%  Commands %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\newcommand{\doubt}[1]{{\textcolor{red}{#1}}}
\newcommand{\addendum}[1]{\textcolor{blue}{#1}}
\newcommand{\optional}[1]{$\mathbf{\bigl[}$#1$\mathbf{\bigr]}$}
\newcommand{\mathoptional}[1]{\ensuremath{\mathbf{\bigl[}#1\mathbf{\bigr]}}}
\newcommand{\implicit}[1]{$\mathbf{\bigl\{}$#1$\mathbf{\bigr\}}$}
\newcommand{\mathimplicit}[1]{\ensuremath{\mathbf{\bigl\{}#1\mathbf{\bigr\}}}}

\newcommand\algname[1]{\texttt{#1}\xspace}

\newcounter{defctr}
\setcounter{defctr}{0}
\renewcommand{\thedefctr}
{\addtocounter{defctr}{1}\thechapter.\arabic{defctr}}

\lstset{
  language=C++,                   % choose the language of the code
  xleftmargin=\parindent,         % leftmargin
  basicstyle=\normalsize\tt,      % the size of the fonts that are used for the code
  keywordstyle=\color{Black},
  numbers=none,                   % where to put the line-numbers
  numberstyle=\normalsize,        % the size of the fonts that are used for the line-numbers
  stepnumber=2,                   % the step between two line-numbers. If it's 1 each line 
                                  % will be numbered
  numbersep=5pt,                  % how far the line-numbers are from the code
  backgroundcolor=\color{white},  % choose the background color. You must add \usepackage{color}
  showspaces=false,               % show spaces adding particular underscores
  showstringspaces=false,         % underline spaces within strings
  showtabs=false,                 % show tabs within strings adding particular underscores
  frame=none,                     % adds a frame around the code
  tabsize=2,                      % sets default tabsize to 2 spaces
  captionpos=b,                   % sets the caption-position to bottom
  breaklines=true,                % sets automatic line breaking
  breakatwhitespace=false,        % sets if automatic breaks should only happen at whitespace
  escapeinside={/<}{>/}           % if you want to add a comment within your code
}

\lstset{
morekeywords={
  opaque,
  uint8,
  uint16,
  uint32,
  uint24,
  uint64,
  len,
}}

\renewcommand{\>} {>>}

\newcommand{\abbr}[1]{\texttt{#1}}

\makeatletter
\newcommand{\anchor}[1]
{\abbr{#1}\def\@currentlabel{\abbr{#1}}\label{#1}}
\makeatother

\newcommand{\up}[1]{$\phantom{\,}^{#1}$}
\newcommand{\starup}{\up{\star}}

\newcounter{reqctr}
\renewcommand{\thereqctr}{\arabic{reqctr}}
\makeatletter
\@addtoreset{reqctr}{section}
\newcommand{\req}[2]{
	\addtocounter{reqctr}{1}
	\def\@currentlabel{#1.\thereqctr}
	{\bf Требование~#1.\thereqctr~(#2)}.\;\xspace
}
\makeatother

\newcommand{\TOE}{\mbox{ПСКЗИ}\xspace}

\newcommand{\forref}[1]{\{\ref{#1}\}}
\newcommand{\useref}[1]{[\ref{#1}]}

\providecommand{\CryptoDisk}{<<{Криптодиск}>>\xspace}

%%%%%%%%%%% Environments %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\makeatletter
\newenvironment{defcaption}[1]{%
	\list{}{\labelwidth 5cm
		\itemindent 0pt
		\labelsep 0pt
		\topsep 0pt
		\parskip 0pt
		\leftmargin 5cm}%
		\item[\abbr{#1}\hfill\mbox{}]
		\def\@currentlabel{\abbr{#1}}\label{#1}
	}%
	{\endlist}
\makeatother

\newenvironment{definition}[2]{%
	\list{}{\labelwidth 0pt
		\itemindent 0pt
		\labelsep 0pt
		\topsep 0pt
		\topskip 16pt
		\partopsep 16pt
		\leftmargin 0pt}%
		\item[]\begin{defcaption}{#1}{\it #2}\end{defcaption}
	}%
	{\endlist}


\newenvironment{remark}
{\list{\csname\@remark\endcsname}%
{\itemsep=0pt\parsep=0pt\parskip=0pt\topsep=0pt\partopsep=0pt
\leftmargin=\parindent
\itemindent=\parindent\addtolength{\itemindent}{-\leftmargin}
\labelsep=6pt
\def\makelabel##1{}}
\small
\item[]Примечание~---
}
{\endlist}

\newenvironment{applnote}{
\par\small{\bfseries Замечание по применению.}
}{}

%%%%%%%%%%% Acronyms %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\newcommand{\ie}{т.~е.\@\xspace}
\newcommand{\iid}{н.~о.~р.\@\xspace}
\newcommand{\iidrv}{н.~о.~р.~с.~в.\@\xspace}

%%%%%%%%%%%%%%%%%%%%%%%% Renew %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\newcommand{\<}{<<}
\renewcommand{\>}{>>}
\renewcommand{\le}{\leqslant}
\renewcommand{\leq}{\leqslant}
\renewcommand{\ge}{\geqslant}
\renewcommand{\geq}{\geqslant}
\renewcommand{\atop}[2]{\genfrac{}{}{0pt}{}{#1}{#2}}
\renewcommand{\pmod}[1]{\allowbreak\ifinner\mkern4mu\else\mkern9mu\fi
({\rm mod}\,\,#1)}
\providecommand{\No}{\textnumero}

%%%%%%%%%%%%%%%%%%%%%%%% Appendix %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\def\apprefix{}
\newenvironment{appendix}[3]
{
  \clearpage
  \chapter*{\mbox{}\hfillПриложение~#1\hfill\mbox{}}%
  \vskip-10pt
  {\centering
    {(#2)}\par
    {\large\bf #3}\par
  }
  \def\@currentlabel{#1}
  \def\apprefix{#1.}
  \def\thechapter{#1}
  \setcounter{table}{0}
  \setcounter{section}{0}
  \addcontentsline{toc}{chapter}{Приложение~#1~(#2)~#3}
}
{
  \def\apprefix{}
  \def\thechapter{\@arabic\c@chapter}
}

%%%%%%%%%%%%%%%%%%%%%%%% Local %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\addto\captionsrussian{%
  \renewcommand{\figurename}{Рисунок}
  \renewcommand\tablename{Таблица}
  \renewcommand\contentsname{Содержание}
  \renewcommand{\bibname}{Библиография}
}

%%
%%
\endinput
