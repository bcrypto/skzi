\section{Самотестирование (СТ)}\label{ST}

\subsection{Обзор}\label{ST.Intro}

Пакет СТ устанавливает требования к контролю состава
и правильного функционирования КСК и собственных компонентов СКЗИ.
%
Для организации контроля выполняется тестирование компонентов.
%
Тестирование выполняет сам СКЗИ, поэтому речь идет о самотестировании.
Тестирование может выполняться сразу после загрузки,
по запросу оператора, автоматически через определенный промежуток времени,
при определенных условиях, например, перед первым выполнением криптографической 
операции.

Перечень КСК, подлежащих тестированию, может быть определен рамочно:
аппаратная платформа, устройства хранения, операционная система. 
Особенно это относится к СКЗИ, которые могут выполняться в модифицируемой 
системной среде~\forref{R.ST.CSCList}.

Тесты КСК могут быть косвенными. Например, успешная загрузка операционной 
системы является основанием для вывода о корректности работы аппаратной 
платформы и устройств хранение. В свою очередь проверка работоспособности 
операционной системы может заключаться в контроле целостности ее отдельных 
файлов~\forref{R.ST.CSCTests}.  

В большинстве случаев нельзя провести исчерпывающее тестирование КСК. 
Допускается, что при тестировании проверяется только 
наличие компонентов и проводится контроль лишь нескольких их основных 
функций~\forref{R.ST.CSCTests}.

Для тестирования криптографических алгоритмов могут использоваться:
тесты известного ответа, тесты тождеств, тесты сравнения, тесты условий, 
тесты на соответствие между открытым и личным ключами. 

В тесте известного ответа криптографический алгоритм обрабатывает
фиксированные входы, полученный выход сравнивается с эталонным.
%
В тесте тождеств проверяются известные свойства алгоритма  
или групп связанных алгоритмов. Например, может проверяться, что расшифрование 
обратно зашифрованию или что проверка только что выработанной ЭЦП завершится 
успешно.
%
В тесте сравнения проверяется совпадение результатов двух независимых
реализаций алгоритма.
%
Тест условий основан на проверках, специально встроенных в реализацию 
алгоритма~\forref{R.ST.Tests}.

Для ускорения тестирования криптографического алгоритма
могут использоваться долговременные параметры минимальной допустимой 
размерности. При тестировании можно учитывать 
использование в алгоритмах одинаковых компонентов и учитывать результаты
одного теста в другом. Успешное выполнение 
криптографического протокола с внешней стороной может быть засчитано
как успешный тест тождеств. Это, например, относится к протоколу 
формирования общего ключа с подтверждением его корректности~\forref{R.ST.Tests}.

% todo: учитывать результаты -> засчитывать результаты

\subsection{Требования}\label{ST.Reqs}

\req{СТ}{1--4}\label{R.ST.CSCList}
Должен быть определен перечень КСК.

\if0
Группы КСК:
\begin{itemize}
\item
устройства ввода, вывода и управления (порты, индикаторы, кнопки);
\item
устройства обработки (процессор, оперативное запоминающее устройство, 
ускоритель криптографических операций); 
\item
устройства передачи (шина данных);
\item
устройства хранения (постоянное, постоянное программируемое и постоянное 
перепрограммируемое запоминающие устройства); 
\item
дополнительное оборудование (генератор случайных чисел, таймер). 
\end{itemize}
\fi

\req{СТ}{1--4}\label{R.ST.CSCTests}
Сразу после включения~СКЗИ должно проверять состав 
и работоспособность КСК~\useref{R.ST.CSCList}.

\begin{note}
Для некоторых компонентов при включении можно провести лишь часть 
проверок. В таких случаях разрешается выполнить пропущенные тесты позднее. 
Например, при включении следует проверить наличие устройства чтения 
смарт-карт, а корректность работы данного устройства можно проверить при 
непосредственном чтении данных с карты. 
\end{note}

\req{СТ}{1--4}\label{R.ST.Tests}
Должны быть определены и \addendum{корректно 
реализованы~\forref{R.CR.Selected,R.CR.Detailed}}
тесты работоспособности СКЗИ.
Перечень тестов должен включать:
\begin{itemize}
\item
тесты криптографических алгоритмов~\useref{R.CS.Algs};
\item
контроль целостности всех системных объектов, включая файлы 
программ~\useref{R.DP.System}.
\end{itemize}
Должны быть предусмотрены~\forref{R.SV.List} сервисы тестирования, реализующие 
тесты перечня. Любой оператор должен иметь~\forref{R.AC.Policy} доступ к 
сервисам \addendum{тестирования}.
%
Кроме этого, каждый криптографический алгоритм должен быть автоматически 
протестирован перед первым использованием.
%
Целостность системных объектов должна быть проверена сразу после включения 
СКЗИ.

\begin{note}
Если имеется несколько реализаций криптографического алгоритма, 
то тестироваться должна каждая из них.
\end{note}

\req{СТ}{1--4}\label{R.ST.TestData}
Тестовые данные криптографических алгоритмов~\useref{R.CS.Algs} 
(ключи, открытые тексты, шифртексты) 
должны быть отнесены~\forref{R.AC.Objects} к открытым объектам.

\req{СТ}{1--4}\label{R.ST.TestLock}
При ошибках тестирования СКЗИ должно переходить~\forref{R.AC.States} 
в состояние блокировки~\useref{R.AC.LockState}.

%\req{СТ}{1--4}\label{R.ST.TestKeypair}
%Если в СКЗИ предусмотрена генерация пар личных и открытых 
%ключей~\useref{R.CS.Gen}, то сразу после генерации пары  
%должен~\forref{R.ST.Tests} выполняться тест на соответствие между открытым и 
%личным ключами. 

\req{СТ}{3, 4}\label{R.ST.Periodic}
Если СКЗИ может эксплуатироваться без выключения в течение длительного интервала
времени, то должно быть предусмотрено периодическое автоматическое выполнение 
тестов~\useref{R.ST.Tests}. Настройка перечня тестов и интервала тестирования
должна быть доступна~\forref{R.AC.Policy} только 
администраторам~\useref{R.AC.Roles}.

\begin{note}
Если в назначенный для тестов момент СКЗИ выполняет операцию, которая не может 
быть прервана, то самотестирование может быть перенесено на более поздний срок
\addendum{или не проведено вовсе}.
% Если речь идет про аппаратный СКЗИ, который выполняет линейное шифрование по 
% синхронному каналу (например, E1), то технологически невозможно определить 
% наличие/отсутствие в канале передаваемой информации в некоторый момент времени. 
% Соответственно, нет возможности провести самотестирование в процессе работы 
% шифратора, так как его запуск может привести к потере передаваемой 
% информации.
\end{note} 
