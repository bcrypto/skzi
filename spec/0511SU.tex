% Software Update
\section{Обновление программ (ОП)}\label{SU}

\subsection{Обзор}\label{SU.Intro}

Пакет ОП устанавливает требования по организации обновления программ СКЗИ.
Программы обновляются после установки средства в связи с его модернизацией, 
расширением функциональных возможностей или в ответ на обнаруженные недостатки.

Предполагается, что обновление реализуется самим СКЗИ. Обновление через 
процедуры в системной среде считается установкой СКЗИ~\useref{R.ES.Install} 
и не подпадает под требования пакета.

Обновляемые программы распространяются на магнитных носителях,
размещаются в локальной сети, публикуются на сайте производителя
(дистрибьютора).
%
Программы импортируются в СКЗИ как открытые системные объекты.

При удаленной загрузке программ контроль их целостности и подлинности 
может проводиться в рамках онлайн-протокола с производителем. В этом протоколе
производитель может проверять разрешение оператора на получение программ. 
Такая проверка не относится к безопасности и не рассматривается в настоящем 
пакете.

Существует угроза намеренного изменения программ СКЗИ так, что по
входам и выходам сервисов СКЗИ измененные программы, реализующие эти сервисы, 
нельзя отличить от настоящих. Другими словами, измененные программы могут 
маскироваться под настоящие. Частичной защитой от угрозы является проверка 
факта хранения в пределах криптографической границы корректных программных 
модулей. Проверка хранения (proof-of-storage) может быть проведена по следующей 
схеме: в ответ на случайный запрос СКЗИ возвращает хэш-значение пары (запрос, 
проверяемый программный модуль)~\forref{R.SU.PoS}.

\subsection{Требования}\label{SU.Reqs}

\req{ОП}{1--4}\label{R.SU.Service}
Должен быть~\forref{R.SV.List} предусмотрен сервис обновления 
программ СКЗИ. Доступ к сервису должны иметь~\forref{R.AC.Policy} 
только администраторы.

\req{ОП}{1--4}\label{R.SU.Logic}
Перед выполнением сервиса обновления программ~\useref{R.SU.Service} 
должно быть прекращено выполнение криптографических сервисов. 
%
Сразу после обновления должно быть проведено 
самотестирование~\useref{R.ST.CSCTests,R.ST.Tests}, 
как если бы речь шла о включении СКЗИ.
%
При ошибке во время обновления должен быть проведен
возврат к действовавшей до обновления версии программ. 

\begin{note}
Возврат означает восстановление как файлов программ, так и связанных с программами 
конфигурационных файлов. 
\end{note}

\req{ОП}{1--4}\label{R.SU.Import}
Обновляемые программы должны быть~\forref{R.AC.Objects} включены в список 
открытых системных объектов. Контроль целостности и подлинности программ
при импорте должен проводиться с помощью криптографических 
методов~\useref{R.DP.CryptoI}. Должны использоваться заранее 
установленные ключи методов контроля. Ключи должны быть~\forref{R.AC.Objects} 
включены в список системных объектов.  

\req{ОП}{1, 2}\label{R.SU.Sig}
Ключи методов контроля целостности и подлинности обновляемых программ должны 
быть открытыми. 

\begin{note}
Может использоваться открытый ключ ЭЦП производителя. Или открытый ключ 
удостоверяющего центра, на котором проверяется сертификат открытого ключа 
производителя в онлайн-протоколе с ним. 
\end{note}

\req{ОП}{1--4}\label{R.SU.Version}
При импорте обновляемых программ должна проверяться их версия.
Должно быть запрещено загружать предыдущие версии программного обеспечения 
вместо действующих. После обновления программ в конфигурационных файлах СКЗИ
должна быть обновлена информация о версии.

\req{ОП}{4}\label{R.SU.PoS}
Должен быть~\forref{R.SV.List} предусмотрен сервис, 
который позволяет убедиться в хранении в пределах криптографической границы
корректных программных модулей.

\req{ОП}{3, 4}\label{R.SU.AU}
Обновление программ должно~\forref{R.AU.Events} регистрироваться в 
журнале аудита. 
%
Запись аудита должна содержать номера действующей и устанавливаемой версий 
программ.

