% Data Protection
\section{Защита объектов (ЗО)}\label{DP}

\subsection{Обзор}\label{DP.Defs}

Пакет ЗО устанавливает требования по защите объектов СКЗИ. 
Защита устанавливается или снимается при записи и чтении объектов 
во время их хранения в пределах криптографической границы, экспорте за ее 
пределы и импорте из-за пределов. 

Предусмотрены следующие методы защиты.

1~{\it Криптографические методы}. 
Состоят в применении алгоритмов шифрования для обеспечения конфиденциальности, 
алгоритмов ЭЦП и имитозащиты для контроля целостности и подлинности.

2~{\it Аппаратные методы}. 
Состоят в аппаратной защите от несанкционированного чтения и (или) модификации
областей памяти, в которых размещаются целевые объекты. 
%
Защита может состоять в размыкании цепей памяти при попытках 
несанкционированного доступа, использовании защищенных модулей памяти, 
контроле четности на аппаратном уровне, хранении объектов в гарантированно 
неизменяемых областях памяти.
%
Аппаратная защита обеспечивается применением смарт-карт, токенов и других
подобных устройств. В их качестве может выступать отдельный аппаратный СКЗИ.
%
Аппаратная защита СКЗИ распространяется на объекты, которые хранятся 
(даже в незашифрованном виде) в пределах его криптографической 
границы~\forref{R.DP.Hard}.

3~{\it Методы разделения секрета}. 
Состоят в разбиении защищаемого критического объекта на частичные секреты, 
каждый из которых затем защищается по отдельности.
%
Простейшим методом разделения секрета является представление
ключа как двоичного слова в виде суммы (поразрядной по модулю $2$)
нескольких частичных секретов. 
В этом случае для восстановления исходного 
ключа требуется располагать всеми частичными секретами.
%
Более сложные пороговые методы позволяют 
определить исходный ключ при наличии не всех, 
а только порогового числа частичных секретов, 
например трех из пяти~\forref{R.DP.Split}.

4~{\it Алгоритмические методы}. 
Состоят в контроле целостности с помощью некриптографических
алгоритмов, бесключевых криптографических алгоритмов
или криптографических алгоритмов с известными всем ключами.
%
К алгоритмическим методам относятся: 
сверка нескольких копий объекта, 
проверка контрольных хэш-значений,
хранение объекта вместе с результатом его зашифрования на нулевом ключе,
проверка самоподписанного сертификата открытого ключа~\forref{R.DP.Algo}.

5~{\it Организационные меры}. 
Состоят в обеспечении конфиденциальности с помощью мероприятий,
не относящихся к информационным технологиям.

6~{\it Системные методы}. 
Состоят в обеспечении конфиденциальности и (или) контроле целостности объектов, 
которые хранятся в пределах криптографической границы, средствами системной 
среды. Простейшим методом защиты является настройка прав доступа к объектам 
(файлам с объектами): доступ может получить только владелец объекта и только 
после успешной аутентификации. Более сложные методы включают 
аутентифицированное шифрование объектов на специальных ключах системной среды.
%
Системные методы могут использоваться только на уровне 1.

При выборе методов защиты предпочтение следует отдавать криптографическим. 
Однако для организации криптографической защиты объектов требуется использовать 
другие объекты-ключи. Эти объекты также нужно защищать, следовательно, нужно 
использоваться новые ключи и т.~д. Аппаратные методы и методы разделения 
секрета позволяют прервать цепочку ключей защиты других ключей.

В алгоритмических методах защиты контрольная характеристика, 
на основании которой принимается решение о целостности объекта, 
может быть вычислена любой стороной. Поэтому алгоритмический метод позволяет 
контролировать только целостность объекта и защищать его только от случайных 
сбоев в системной среде, но не от преднамеренного воздействия. 
%
Однако если контрольная характеристика защищается, то защита распространяется
на контролируемый объект. 
%
Пусть, например, СКЗИ вырабатывает личный и открытый ключи,
сохраняет личный ключ на смарт-карту, 
а открытый ключ отсылает в удостоверяющий центр для получения сертификата. 
%
После получения сертификата СКЗИ вычисляет по сохраненному личному ключу 
открытый и сравнивает его с ключом, размещенным в сертификате.
%
Проверка связи между ключами соответствует алгоритмическому методу защиты.
Аппаратная защита личного ключа распространяется в момент импорта
на открытый ключ сертификата~\forref{R.DP.Algo}.

Защита экспортируемого критического объекта выполняется непосредственно в момент
экспорта. Для сравнения, защита экспортируемого открытого объекта может быть
отложена: выполнена позже силами доверенных СКЗИ в системной среде.
%
Установка защиты в любом случае будет проверена при импорте. 
%
Данные правила защиты распространяются на запись и чтение объектов при 
их хранении в пределах криптографической границы~\forref{R.DP.Export,R.DP.Import}. 

Экспортом не считается передача объекта во владение другому СКЗИ в системной
среде.
%
Например, передача случайных чисел от средства их генерации средству
персонализации аппаратных криптографических устройств, которое строит по 
случайным числам личные ключи устройств и записывает их на устройства
(экспорт)~\forref{R.DP.Export}. 

Защита критических объектов предполагает их надежную очистку.
%
Очистка объектов в энергозависимой памяти может быть произведена перезаписью 
ячеек памяти либо отключением питания.
%
Для очистки содержимого энергонезависимой памяти следует использовать
многократную перезапись ячеек памяти битовыми строками со средним, малым и 
большим числом единиц. Рекомендуется проводить несколько повторов трехцикловой 
перезаписи сначала случайной строкой, затем нулевой строкой и 
наконец строкой из всех единиц. 
%
После циклов перезаписи рекомендуется проводить контрольное считывание ячеек 
памяти~\forref{R.DP.Zero}.

\subsection{Требования}\label{DP.Reqs}

\req{ЗО}{1--4}\label{R.DP.Crit} % 1
Должна обеспечиваться конфиденциальность критических объектов~\useref{R.AC.Objects}.
%
Используемые для этого методы защиты должны выбираться из следующего списка:
криптографические, аппаратные, разделения секрета.
%
При защите частичных секретов список дополняется организационными мерами.
%
На уровне 1 при защите объектов во время хранения список дополняется системными 
методами. 

\req{ЗО}{1--4}\label{R.DP.Public} % 2
Должен осуществляться контроль целостности и подлинности критических и открытых
объектов~\useref{R.AC.Objects}. 
%
Используемые для этого методы защиты должны выбираться из следующего списка: 
криптографические, аппаратные, алгоритмические.
%
На уровне 1 при контроле целостности объектов во время хранения список 
дополняется системными методами.

\req{ЗО}{1--4}\label{R.DP.CryptoE} % 3
Должны быть определены и корректно 
реализованы~\forref{R.CR.Embed,R.CR.Selected,R.CR.Detailed} 
криптографические методы обеспечения конфиденциальности.
%
Методы должны быть основаны на алгоритмах шифрования~\useref{R.CS.Algs}.
%
Личные и секретные ключи алгоритмов должны быть 
отнесены~\forref{R.AC.Objects} к критическим объектам, а открытые 
ключи и долговременные параметры~--- \forref{R.AC.Objects}~к открытым объектам. 

\begin{note}
При планировании защиты следует руководствоваться правилом:
ключ защиты не должен быть слабее защищаемого критического объекта. 
%
Например, не следует устанавливать защиту 256-битового ключа на 128-битовом. 
\end{note}

\req{ЗО}{1--4}\label{R.DP.CryptoI} % 4
Должны быть определены и корректно 
реализованы~\forref{R.CR.Embed,R.CR.Selected,R.CR.Detailed} 
криптографические методы контроля
целостности и подлинности. Методы должны быть основаны на алгоритмах 
ЭЦП и имитозащиты~\useref{R.CS.Algs}.
%
Личный ключ ЭЦП и секретный ключ имитозащиты должны быть 
отнесены~\forref{R.AC.Objects} к критическим объектам, а открытый ключ ЭЦП и 
долговременные параметры~--- \forref{R.AC.Objects}~к открытым объектам.
%
Длина имитовставки в битах должна быть не меньше~$64$.

\req{ЗО}{1--4}\label{R.DP.Hard} % 5
Должны быть определены и корректно использованы аппаратные методы защиты.
Устройства, которые реализуют аппаратные методы, 
должны соответствовать ТНПА в части физической безопасности.
%
При отсутствии подходящих ТНПА должна быть проведена оценка надежности
устройств.

\begin{note}
При оценке надежности следует учитывать требования пакета ФБ (п.~\ref{PS}),
декларации разработчиков устройств, сведения о применении устройств, опыт 
применения.
\end{note}

\req{ЗО}{1--4}\label{R.DP.Split} % 6
Должны быть определены и корректно
реализованы~\forref{R.CR.Embed,R.CR.Selected,R.CR.Detailed}  методы разделения
секрета. При восстановлении критического объекта должно использоваться не менее
двух различных частичных секретов.
%
Если для восстановления критического объекта требуется $k$ частичных секретов,
то любые $k-1$ частичных секретов не должны давать никакой информации об 
исходном объекте.
%
Частичные секреты должны быть отнесены~\forref{R.AC.Objects} к критическим объектам.

\begin{note}
Владельцы частичных секретов не обязательно различны. 
Один оператор может владеть сразу всеми частичными секретами.
\end{note}

\req{ЗО}{1--4}\label{R.DP.Algo} % 7
Должны быть определены и корректно 
реализованы~\forref{R.CR.Selected,R.CR.Detailed} алгоритмические методы 
контроля целостности.
%
Алгоритмические методы контроля должны гарантировать, что
\begin{itemize}
\item
вероятность необнаружения случайной модификации контролируемого 
объекта при его хранении не превышает~$2^{-32}$;
\item
вероятность необнаружения намеренной модификации контролируемого 
объекта при его импорте не превышает~$2^{-128}$.
\end{itemize}

Если контролируемый объект не является частичным секретом или системным
объектом, то его контрольная характеристика должна быть 
отнесена~\forref{R.AC.Objects} к открытым или критическим объектам.

\req{ЗО}{1--4}\label{R.DP.Org} % 8
Должны быть определены и изложены~\forref{R.GD.Admin,R.GD.Roles} 
в руководствах организационные меры обеспечения конфиденциальности 
частичных секретов. Меры должны быть направлены на ограничение физического 
доступа к носителям информации, на которых хранятся секреты, и 
противодействие попаданию порогового числа частичных секретов 
противнику. 

\req{ЗО}{1--4}\label{R.DP.Export} % 9
При записи на хранение и экспорте критических объектов должна 
устанавливаться их защита~\useref{R.DP.Crit}.

\begin{note}
Экспорт и импорт могут проводиться в рамках онлайн-взаимодействия с удаленным
оператором. При использовании криптографических методов ключи защиты 
могут генерироваться с помощью протоколов формирования общего 
ключа~\useref{R.CS.Gen}.
\end{note}

\req{ЗО}{1--4}\label{R.DP.Import} % 10
При чтении во время хранения и импорте критических и открытых объектов  
должен проводиться контроль их целостности и подлинности~\useref{R.DP.Public}. 
При ошибке контроля использование объекта должно быть запрещено. 

\req{ЗО}{1--4}\label{R.DP.System} % 11
Контроль целостности системных объектов~\useref{R.DP.Public} 
должен проводиться~\forref{R.ST.Tests} при самотестировании.

\req{ЗО}{1--4}\label{R.DP.Session} % 12
Все сеансовые критические объекты~\useref{R.AC.Objects}
должны очищаться до завершения сеансов.

\req{ЗО}{1--4}\label{R.DP.Zero} % 13
Очистка долговременных и сеансовых критических объектов~\useref{R.AC.Objects} 
должна быть реализована так, чтобы после очистки нельзя было определить 
первоначальное значение объекта. 

\req{ЗО}{1--4}\label{R.DP.NonExtr} % 14
Экспорт неизвлекаемых объектов~\useref{R.AC.Objects} должен быть либо полностью 
запрещен, либо применяться исключительно для резервного сохранения 
и выполняться с помощью методов разделения секрета. 

\req{ЗО}{1}\label{R.DP.Sys} % 15
Должны быть определены и корректно использованы системные методы защиты.
Применение системных методов должно быть поддержано~\forref{R.ES.Objects}
при настройке системной среды.

