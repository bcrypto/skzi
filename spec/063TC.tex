% Trusted Channel
\section{Доверенный канал (ДК)}\label{TC}

\subsection{Обзор}\label{TC.Intro}

Пакет ДК устанавливает требования по защите канала связи между СКЗИ и 
удаленным оператором. 
%
Канал продолжает устройства ввода и вывода СКЗИ в недоверенной среде 
эксплуатации, позволяя оператору проводить обычные сеансы,
как если бы он непосредственно работал со средством.

Оператор создает канал и управляет им с помощью клиентской программы. 
\addendum{
Клиентская программа выполняет криптографическую защиту данных обмена и, 
таким образом, выступает в роли СКЗИ. 
%
Клиентская программа имеет собственную системную среду, которая логически 
расширяет системную среду СКЗИ, продолжая ее правила аутентификации,
управления доступом, защиты сеансов и др.~\forref{R.TC.GD}.
}

В ходе сеанса оператор и СКЗИ обмениваются выходными и выходными данными 
сервисов, а также дополнительно текстовыми сообщениями (удаленный терминал),  
данными графического пользовательского интерфейса (удаленный рабочий стол),
кодом (скрипты браузера) \addendum{и др.}
%
При создании канала генерируются ключи, на которых данные обмена защищаются. 
Обычно для генерации ключей используется протокол формирования общего 
ключа. Стороны протокола используют долговременные ключи или 
пароли~\forref{R.TC.Crypto}.

Среди входных и выходных данных сервисов могут быть объекты СКЗИ 
перечня~\useref{R.AC.Objects}. Передача объектов между оператором и средством 
считается экспортом~/ импортом, и поэтому объекты обязательно защищаются с помощью 
криптографических методов~\useref{R.DP.CryptoE,R.DP.CryptoI}. Защита объектов 
может быть совмещена с защитой других данных обмена, может выполняться 
независимо или дополнительно~\forref{R.TC.Crypto}.

Оператор проходит аутентификацию перед СКЗИ и, кроме этого, проводит встречную 
аутентификацию. Встречная аутентификация защищает от атак <<противник 
посередине>>. Она может быть частью протокола формирования общего 
ключа~\forref{R.TC.Auth2}.

Существует угроза определения текущих данных обмена в будущем, после раскрытия 
долговременных ключей или паролей. Для противодействия угрозе обеспечивается 
защита от <<чтения назад>>. Обычно для этого в протокол формирования общего ключа
вводят дополнительные сеансовые ключи~\forref{R.TC.FSWeak,R.TC.FS}. 

\addendum{Одним из} способов реализации доверенного канала 
\addendum{является применение} протокола TLS, определенного в СТБ 
34.101.65. При этом способе криптографическая защита канала регулируется 
криптонаборами TLS, которые представляют собой взаимосвязанные 
криптографические алгоритмы разного назначения.

\addendum{
На уровне 1 клиентская программа как СКЗИ не обязана удовлетворять всем 
требованиям настоящего стандарта, и поэтому в ней для реализации доверенного 
канала могут использоваться криптографические алгоритмы, не подпадающие под 
требование~\ref{R.CS.Std}. В частности, может использоваться 
протокол TLS с криптонаборами, не установленными в ТНПА и не 
реализованными в СКЗИ.  
%
При этом на стороне СКЗИ для защиты данных обмена (исключая объекты СКЗИ) 
могут применяться внешние криптографические средства. 
%
Внешние средства обязательно входят в состав КСК~\useref{R.ST.CSCList} 
и подпадают под контроль.
}

\subsection{Требования}\label{TC.Reqs}

\req{ДК}{1--4}\label{R.TC.GD} % 1
В руководствах должны быть~\forref{R.GD.Admin,R.GD.Roles}
представлены правила настройки клиентской программы, которая используется для  
связи между удаленным оператором и СКЗИ, \addendum{а также правила настройки 
системной среды клиентской программы. 
%
Правила настройки системной среды клиентской программы должны 
соответствовать правилам настройки системной среды СКЗИ.}

\req{ДК}{2--4}\label{R.TC.Client} % 2
\addendum{
Клиентская программа должна удовлетворять требованиям настоящего стандарта. 
}

\req{ДК}{\addendum{2--4}}\label{R.TC.Auth} % 3
\addendum{При аутентификации удаленного оператора
должно использоваться не менее двух факторов аутентификации.}

\req{ДК}{1--4}\label{R.TC.Auth2} % 4
Должна проводиться встречная аутентификация СКЗИ перед удаленным оператором.
Вероятность пройти аутентификацию, не зная секрета аутентификации, 
не должна превышать~$2^{-64}$.

\req{ДК}{1--4}\label{R.TC.Logout} % 5
У удаленного оператора должна быть возможность завершить сеанс в любой момент 
времени. Сеанс должен автоматически завершаться при отсутствии активности 
оператора в течение определенного времени.

\req{ДК}{1--4}\label{R.TC.Crypto} % 6
Должны быть обеспечены конфиденциальность, контроль целостности и подлинности 
данных обмена между удаленным оператором \addendum{и С}КЗИ.
%
Для защиты должны использоваться криптографические методы.
%
Ключи защиты должны обновляться в каждом новом сеансе оператора.

\begin{note}
Сеанс оператора можно сохранить (кэшировать), а затем возобновить.
При возобновлении сеанса ключи защиты обновлять необязательно.
\end{note}

\req{ДК}{2--4}\label{R.TC.Keys} % 7
В формировании ключей защиты~\useref{R.TC.Crypto} должен участвовать СКЗИ.

\begin{note}
Недопустима ситуация, когда СКЗИ не влияет на формирование ключей защиты.
Например, когда их генерирует удаленный оператор и пересылает 
в зашифрованном на открытом ключе СКЗИ виде.
\end{note}

\req{ДК}{1--4}\label{R.TC.Pwd} % 8
Если ключи защиты~\useref{R.TC.Crypto} формируются на основании пароля
удаленного оператора, то этот пароль должно быть вычислительно
трудно определить по данным обмена между оператором и СКЗИ.

\req{ДК}{3, 4}\label{R.TC.FSWeak} % 9
Ключи защиты~\useref{R.TC.Crypto} должны формироваться так, чтобы их было 
\addendum{вычислительно} трудно определить даже после раскрытия 
долговременн\addendum{ых} ключ\addendum{ей} \addendum{и} 
парол\addendum{ей} удаленного оператора.

\req{ДК}{4}\label{R.TC.FS} % 10
Ключи защиты~\useref{R.TC.Crypto} должны формироваться так, 
чтобы их было \addendum{вычислительно} трудно определить даже после 
раскрытия долговременн\addendum{ых} ключ\addendum{ей} СКЗИ.

\req{ДК}{3, 4}\label{R.TC.AU} % 11
Открытие и закрытие доверенного канала должны~\forref{R.AU.Events} 
регистрироваться в журнале аудита. Запись аудита должна идентифицировать 
клиентскую программу.



